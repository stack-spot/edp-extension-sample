import { HttpError } from '@oazapfts/runtime'
import { defaults, downloadAccountData } from '../api/insights'
import apis from '../apis.json'
import { DefaultAPIError } from '../error/DefaultAPIError'
import { baseDictionary } from '../error/dictionary/base'
import { StackspotAPIError } from '../error/StackspotAPIError'
import { ReactQueryNetworkClient } from '../network/ReactQueryNetworkClient'

class InsightsClient extends ReactQueryNetworkClient {

  constructor() {
    super(apis.insights.url, defaults)
  }

  protected buildStackSpotError(error: HttpError): StackspotAPIError {
    return new DefaultAPIError(error.data, error.status, baseDictionary, error.headers)
  }
  /**
   * Download account Data
   */
  downloadAccountData = this.query(downloadAccountData)
}

export const insightsClient = new InsightsClient()
