import { HttpError } from '@oazapfts/runtime'

import apis from '../apis.json'
import { DefaultAPIError } from '../error/DefaultAPIError'
import { StackspotAPIError } from '../error/StackspotAPIError'
import { ReactQueryNetworkClient } from '../network/ReactQueryNetworkClient'
import { removeAuthorizationParam } from '../utils/remove-authorization-param'
import { apply, defaults } from '../api/cloudPlatformHorizon'
import { baseDictionary } from '../error/dictionary/base'

class CloudPlatformHorizonClient extends ReactQueryNetworkClient {
  constructor() {
    super(apis.cloudPlatformHorizon.url, defaults)
  }

  protected buildStackSpotError(error: HttpError): StackspotAPIError {
    return new DefaultAPIError(error.data, error.status, baseDictionary, error.headers)
  }
  /**
   * Apply manifesto resource
   */
  apply = this.mutation(removeAuthorizationParam(apply))
}

export const cloudPlatformHorizonClient = new CloudPlatformHorizonClient()
