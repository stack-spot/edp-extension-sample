"use strict";var D=Object.defineProperty,x=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var H=(r,e,t)=>e in r?D(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,h=(r,e)=>{for(var t in e||(e={}))j.call(e,t)&&H(r,t,e[t]);if(g)for(var t of g(e))O.call(e,t)&&H(r,t,e[t]);return r},y=(r,e)=>x(r,A(e));var S=(r,e)=>{var t={};for(var s in r)j.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&g)for(var s of g(r))e.indexOf(s)<0&&O.call(r,s)&&(t[s]=r[s]);return t};var E=(r,e,t)=>(H(r,typeof e!="symbol"?e+"":e,t),t);var m=(r,e,t)=>new Promise((s,f)=>{var n=a=>{try{c(t.next(a))}catch(o){f(o)}},i=a=>{try{c(t.throw(a))}catch(o){f(o)}},c=a=>a.done?s(a.value):Promise.resolve(a.value).then(n,i);c((t=t.apply(r,e)).next())});Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const U=require("./query.cjs"),B=require("./util.cjs"),w=require("./headers.cjs");function F(r={}){function e(n,i){return m(this,null,function*(){const c=yield f(n,i);let a;try{a=yield c.text()}catch(o){}return{status:c.status,headers:c.headers,contentType:c.headers.get("content-type"),data:a}})}function t(c){return m(this,arguments,function*(n,i={}){const{status:a,headers:o,contentType:u,data:p}=yield e(n,y(h({},i),{headers:w.mergeHeaders({Accept:"application/json"},i.headers)}));return(u?u.includes("json"):!1)?{status:a,headers:o,data:p?JSON.parse(p):null}:{status:a,headers:o,data:p}})}function s(c){return m(this,arguments,function*(n,i={}){const a=yield f(n,i);let o;try{o=yield a.blob()}catch(u){}return{status:a.status,headers:a.headers,data:o}})}function f(c){return m(this,arguments,function*(n,i={}){const d=y(h(h({},r),i),{headers:w.mergeHeaders(r.headers,i.headers)}),{baseUrl:a,fetch:o}=d,u=S(d,["baseUrl","fetch"]),p=B.joinUrl(a,n);return yield(o||fetch)(p,u)})}return{ok:b,fetchText:e,fetchJson:t,fetchBlob:s,mergeHeaders:w.mergeHeaders,json(a){var o=a,{body:n,headers:i}=o,c=S(o,["body","headers"]);return y(h(h({},c),n!=null&&{body:JSON.stringify(n)}),{headers:w.mergeHeaders({"Content-Type":"application/json"},i)})},form(a){var o=a,{body:n,headers:i}=o,c=S(o,["body","headers"]);return y(h(h({},c),n!=null&&{body:U.form(n)}),{headers:w.mergeHeaders({"Content-Type":"application/x-www-form-urlencoded"},i)})},multipart(a){var o=a,{body:n,headers:i}=o,c=S(o,["body","headers"]);if(n==null)return y(h({},c),{body:n,headers:w.normalizeHeaders(i)});const u=new(r.formDataConstructor||c.formDataConstructor||FormData),p=(l,d)=>{typeof d=="string"||d instanceof Blob?u.append(l,d):typeof d=="number"?u.append(l,String(d)):u.append(l,new Blob([JSON.stringify(d)],{type:"application/json"}))};return Object.entries(n).forEach(([l,d])=>{Array.isArray(d)?d.forEach(k=>p(l,k)):p(l,d)}),y(h({},c),{body:u,headers:w.normalizeHeaders(i)})}}}function N(r,e){return m(this,null,function*(){const{status:t,data:s,headers:f}=yield r,n=e[t];if(n)return n(s);if(e.default)return e.default(t,s);throw new C(t,s,f)})}const J=[200,201,202,204];function b(r){return m(this,null,function*(){const e=yield r;if(J.some(t=>t==e.status))return e.data;throw new C(e.status,e.data,e.headers)})}function T(r){return(...e)=>b(r(...e))}function z(r){const e={};return Object.entries(r).forEach(([t,s])=>{e[t]=typeof s=="function"?T(s):s}),e}class C extends Error{constructor(t,s,f){super(`Error: ${t}`);E(this,"status");E(this,"data");E(this,"headers");this.status=t,this.data=s,this.headers=f}}exports.HttpError=C;exports.SUCCESS_CODES=J;exports.handle=N;exports.ok=b;exports.okify=T;exports.optimistic=z;exports.runtime=F;
//# sourceMappingURL=index.cjs.map
