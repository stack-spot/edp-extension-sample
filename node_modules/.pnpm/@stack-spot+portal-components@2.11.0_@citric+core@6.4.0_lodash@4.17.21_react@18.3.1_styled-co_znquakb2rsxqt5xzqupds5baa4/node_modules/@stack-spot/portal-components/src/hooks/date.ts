import { Language, useLanguage } from '@stack-spot/portal-translate'
import { format } from 'date-fns'
import { ptBR } from 'date-fns/locale'

function formatDate(date: string, locale: Language, includeTime: boolean) {
  const time = includeTime ? ' HH:mm' : ''
  return locale === 'pt'
    ? format(new Date(date), `dd/MM/yyyy${time}`, { locale: ptBR })
    : format(new Date(date), `MMMM dd yyyy${time}`)
}

/**
 * A utility for formatting dates.
 * @param date 
 * @returns a date formatter object.
 */
export function useDateFormatter() {
  const locale = useLanguage()
  return {
    formatDate: (date?: string) => date ? formatDate(date, locale, false) : undefined,
    formatDateWithTime: (date?: string) => date ? formatDate(date, locale, true) : undefined,
  }
}
