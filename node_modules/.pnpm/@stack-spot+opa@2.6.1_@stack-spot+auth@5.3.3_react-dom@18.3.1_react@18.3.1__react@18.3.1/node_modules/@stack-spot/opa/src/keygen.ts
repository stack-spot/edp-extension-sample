import { ValidationRequest } from '../../commons/types'

export function requestAsKey(req: ValidationRequest) {
  return `${req.path}|${req.api}|${req.method}|${req.body ?? ''}|${getHeadersKey(req.headers)}`
}

function getHeadersKey(headers: Record<string, string> | undefined) {
  if (!headers) return ''
  const keys = Object.keys(headers)
  keys.sort()
  keys.map(k => `${k}:${headers[k]}`).join(',')
}
