import { useEffectOnce } from '@stack-spot/portal-components';
const loadScript = () => new Promise((resolve, reject) => {
    const script = document.createElement('script');
    script.setAttribute('src', '//embed.typeform.com/next/embed.js');
    script.setAttribute('async', 'true');
    script.onload = () => resolve();
    script.onerror = (error) => reject(error);
    document.body.appendChild(script);
});
// Function to check if the difference between two dates is greater than 30 days
export function isLessThan30Days(date1, date2) {
    // Get the timestamps of the dates
    const timestamp1 = date1.getTime();
    const timestamp2 = date2.getTime();
    // Calculate the difference in milliseconds
    const differenceInMilliseconds = Math.abs(timestamp2 - timestamp1);
    // Convert milliseconds to days
    const differenceInDays = differenceInMilliseconds / (1000 * 60 * 60 * 24);
    // Check if the difference is fewer than 30 days
    return differenceInDays < 30;
}
// Function to check if a day is business day
const isBusinessDay = (date) => {
    const dayOfWeek = date.getDay();
    return dayOfWeek !== 0 && dayOfWeek !== 6; // 0 = sunday, 6 = saturday
};
// Function that returns a boolean to show modal feedback
export const shouldShowNpsModal = () => {
    const today = new Date();
    const currentDay = today.getDate();
    // Check if the month has already been evaluated
    const ratedInfo = localStorage.getItem('RATED_US_IN');
    if (ratedInfo) {
        const savedDate = new Date(parseInt(ratedInfo, 10));
        const isSameMonth = savedDate.getMonth() === today.getMonth() && savedDate.getFullYear() === today.getFullYear();
        // If it has already been evaluated this month, do not show the modal
        if (isSameMonth)
            return false;
    }
    // Variables to control working days shown and extension day
    let businessDaysShown = 0;
    let day = 25;
    // Iterate from the 25th until you can show 3 business days
    while (businessDaysShown < 3) {
        const checkDate = new Date(today.getFullYear(), today.getMonth(), day);
        if (isBusinessDay(checkDate)) {
            businessDaysShown++;
        }
        // If we are on the current day and have not yet completed the working days, show the modal
        if (currentDay === day) {
            return true;
        }
        day++;
    }
    return false;
};
export function useRatingEffect() {
    const handleInit = async () => {
        await loadScript();
    };
    useEffectOnce(() => {
        handleInit();
    });
}
//# sourceMappingURL=hook.js.map